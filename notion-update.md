# GraphAI × Discord マルチモーダルチャットボット「ボッチー」開発方針更新

## 最新の実装変更点 (2025年4月9日)

1. **アーキテクチャの簡略化**
   - GraphAIライブラリの使用に伴う問題が解決できなかったため、シンプルなGemini直接連携に変更
   - GraphAIフレームワークに代わるシンプルなエンジン実装を導入
   - ウェブ検索機能の実装は一時中断

2. **Gemini AIに集中**
   - Gemini 2.0 Flash AIを直接使用した自然言語対話機能に集中
   - シンプルながら堅牢なコンテキスト管理システムを実装
   - 現在のメイン目標は安定稼働と高品質な対話体験です

3. **優先実装機能**
   - テキスト対話処理（実装済み）
   - 会話履歴管理（実装済み）
   - エラーハンドリングの改善（実装済み）
   - `/clear` コマンドによる会話履歴のクリア（実装済み）
   - 画像理解機能（近日実装予定）

## 現在の状態

- Railway.appにデプロイしたNode.js v20環境で稼働
- Blob APIのpolyfillを追加して初期化問題を解決
- GraphAIフレームワークに依存せず、Gemini APIを直接連携
- Discord.js連携部分を改善し、エラーハンドリングを強化

## 今後の展開

1. **短期目標**
   - 画像理解機能の実装
   - エラー通知メカニズムの追加
   - パフォーマンスとメモリ使用量の最適化

2. **中期目標**
   - 会話履歴のより高度な管理（複数の会話セッション）
   - 機能コマンドの拡充（翻訳、要約など）
   - 画像生成機能の実装（Recraft API連携）

3. **長期目標**
   - ウェブ検索機能の実装（BraveAPIを使用）
   - パーソナライズされた応答システムの構築
   - 音声対応（Discord音声チャンネル）

## 【実装詳細】

### Geminiエンジン
- Gemini 2.0 Flash AIを使用した対話処理
- トークン最適化のためのコンテキスト管理
- 会話履歴のJSON形式での永続化

### Discord連携
- メンション、DM、スレッド返信での応答
- 複数サーバー対応の準備
- エラーハンドリングとログ記録

### コンテキスト管理
- ユーザーごとの会話履歴の保存
- 最大10ターンの会話コンテキスト
- `/clear` コマンドによる会話リセット

## 【リソース】
- Gemini API ドキュメント: https://ai.google.dev/gemini-api/docs
- Discord.js ドキュメント: https://discord.js.org/
- Railway ドキュメント: https://docs.railway.app/

この方針更新に基づき、より安定したデプロイを続行しています。